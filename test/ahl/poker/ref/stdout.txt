WELCOME TO THE HALLDEN CASINO. WE EACH HAVE $200
I WILL OPEN THE BETTING BEFORE THE DRAW; YOU OPEN AFTER
WHEN YOU FOLD, BET 0; TO CHECK, BET .5
ENOUGH TALK  LET'S GET DOWN TO BUSINESS


THE ANTE IS $5. I WILL DEAL

YOUR HAND:
 1-   2  OF CLUBS                2-   4  OF SPADES              
 3-   6  OF HEARTS               4-   5  OF DIAMONDS            
 5-  KING OF HEARTS             

I CHECK
WHAT IS YOUR BET? 20
I FOLD

YOU WIN
NOW I HAVE $ 195 AND YOU HAVE $ 205
DO YOU WISH TO CONTINUE? YES

THE ANTE IS $5. I WILL DEAL

YOUR HAND:
 1-  QUEEN OF HEARTS             2-   2  OF CLUBS               
 3-  ACE OF SPADES               4-  QUEEN OF DIAMONDS          
 5-   10  OF HEARTS             

I'LL OPEN WITH  29
WHAT IS YOUR BET? 30
I'LL SEE YOU, AND RAISE Y0U 27
WHAT IS YOUR BET? 20
IF YOU CAN'T SEE MY BET, THEN FOLD
WHAT IS YOUR BET? 30
I'LL SEE YOU, AND RAISE Y0U 6
WHAT IS YOUR BET? 6

NOW WE DRAW -- HOW MANY CARDS SO YOU WANT? 2
WHAT ARE THEIR NUMBERS
? 5
? 2
YOUR NEW HAND: 
 1-  QUEEN OF HEARTS             2-   5  OF CLUBS               
 3-  ACE OF SPADES               4-  QUEEN OF DIAMONDS          
 5-  QUEEN OF CLUBS             

I AM TAKING 1CARDS

WHAT IS YOUR BET? 20
I FOLD

YOU WIN
NOW I HAVE $ 124 AND YOU HAVE $ 276
DO YOU WISH TO CONTINUE? NO
STOP in line 410

1 (1) DIM A(15), B(10)
2 FNA(_) (0) DEF FNA(X) = INT(10 * RND(X))
3 FNB(_) (0) DEF FNB(X) = X - 100 * INT(X / 100)
4 (1) PRINT "WELCOME TO THE HALLDEN CASINO. WE EACH HAVE $200"
5 (1) PRINT "I WILL OPEN THE BETTING BEFORE THE DRAW; YOU OPEN AFTER"
6 (1) PRINT "WHEN YOU FOLD, BET 0; TO CHECK, BET .5"
7 (1) PRINT "ENOUGH TALK  LET'S GET DOWN TO BUSINESS"
8 (1) PRINT
9 (1) LET O = 1
10 (1) LET C = 200
11 (1) LET S = 200
12 (65) (2) LET P = 0
13 (65) (2) RANDOM
14 (65) (2) PRINT
15 (65) (2) IF C <= 5 THEN 367
16 (65) (2) PRINT "THE ANTE IS $5. I WILL DEAL"
17 (65) (2) PRINT
18 (65) (2) IF S > 5 THEN 20
19 (65) (0) GOSUB 383
20 (65) (2) LET P = P + 10
21 (65) (2) LET S = S - 5
22 (65) (2) LET C = C - 5
23 (65) (2) FOR Z = 1 TO 10
24 (65) (20) GOSUB 174
25 (65) (20) NEXT Z
26 (65) (2) PRINT "YOUR HAND:"
27 (65) (2) LET N = 1
28 (65) (2) GOSUB 185
29 (65) (2) LET N = 6
30 (65) (2) LET I = 2
31 (65) (2) GOSUB 217
32 (65) (2) PRINT
33 (65) (2) IF I <> 6 THEN 47
34 (65) (2) IF FNA(0) <= 7 THEN 37
35 (65) (0) LET X = 11100
36 (65) (0) GOTO 42
37 (65) (2) IF FNA(0) <= 7 THEN 40
38 (65) (1) LET X = 11110
39 (65) (1) GOTO 42
40 (65) (1) IF FNA(0) >= 1 THEN 45
41 (65) (0) LET X = 11111
42 (65) (1) LET I = 7
43 (65) (1) LET Z = 23
44 (65) (1) GOTO 58
45 (65) (1) LET Z = 1
46 (65) (1) GOTO 51
47 (65) (0) IF U >= 13 THEN 54
48 (65) (0) IF FNA(0) >= 2 THEN 50
49 (65) (0) GOTO 42
50 (65) (0) LET Z = 0
51 (65) (1) LET K = 0
52 (65) (1) PRINT "I CHECK"
53 (65) (1) GOTO 62
54 (65) (0) IF U <= 16 THEN 57
55 (65) (0) LET Z = 2
56 (65) (0) IF FNA(0) >= 1 THEN 58
57 (65) (0) LET Z = 35
58 (65) (1) LET V = Z + FNA(0)
59 (65) (1) GOSUB 348
60 (65) (1) PRINT "I'LL OPEN WITH " V
61 (65) (1) LET M = V
62 (65) (2) GOSUB 305
63 (65) (2) GOSUB 65
64 (65) (1) GOTO 82
65 (65) (3) IF I <> 3 THEN 76
66 (65) (0) PRINT
67 (65) (0) PRINT "I WIN"
68 (65) (0) LET C = C + P
69 (65) (2) PRINT "NOW I HAVE $" C " AND YOU HAVE $" S
70 (65) (2) PRINT "DO YOU WISH TO CONTINUE";
71 (65) (2) INPUT H$
72 (65) (2) IF H$ = "YES" THEN 12
73 (65) (1) IF H$ = "NO" THEN 410
74 (65) (0) PRINT "ANSWER YES OR NO, IDIOT"
75 (65) (0) GOTO 70
76 (65) (3) IF I <> 4 THEN 81
77 (65) (2) PRINT
78 (65) (2) PRINT "YOU WIN"
79 (65) (2) LET S = S + P
80 (65) (2) GOTO 69
81 (65) (1) RETURN
82 (65) (1) PRINT
83 (65) (1) PRINT "NOW WE DRAW -- HOW MANY CARDS SO YOU WANT";
84 (65) (1) INPUT T
85 (65) (1) IF T = 0 THEN 98
86 (65) (1) LET Z = 10
87 (65) (1) IF T < 4 THEN 90
88 (65) (0) PRINT "YOU CAN'T DRAW MORE THAN THREE CARDS"
89 (65) (0) GOTO 84
90 (65) (1) PRINT "WHAT ARE THEIR NUMBERS"
91 (65) (1) FOR Q = 1 TO T
92 (65) (2) INPUT U
93 (65) (2) GOSUB 173
94 (65) (2) NEXT Q
95 (65) (1) PRINT "YOUR NEW HAND: "
96 (65) (1) LET N = 1
97 (65) (1) GOSUB 185
98 (65) (1) LET Z = 10 + T
99 (65) (1) FOR U = 6 TO 10
100 (65) (5) IF INT(X / 10 ^ (U - 6)) <> 10 * INT(X / 10 ^ (U - 5)) THEN 102
101 (65) (1) GOSUB 173
102 (65) (5) NEXT U
103 (65) (1) PRINT
104 (65) (1) PRINT "I AM TAKING" Z - 10 - T "CARD";
105 (65) (1) IF Z = 11 * T THEN 109
106 (65) (1) PRINT "S"
107 (65) (1) PRINT
108 (65) (1) GOTO 110
109 (65) (0) PRINT
110 (65) (1) LET N = 6
111 (65) (1) LET V = 1
112 (65) (1) LET I = 1
113 (65) (1) GOSUB 217
114 (65) (1) LET B = U
115 (65) (1) LET M = D
116 (65) (1) IF V <= 7 THEN 119
117 (65) (0) LET Z = 28
118 (65) (0) GOTO 133
119 (65) (1) IF I <> 6 THEN 122
120 (65) (1) LET Z = 1
121 (65) (1) GOTO 133
122 (65) (0) IF U >= 13 THEN 127
123 (65) (0) LET Z = 2
124 (65) (0) IF FNA(0) <> 6 THEN 126
125 (65) (0) LET Z = 19
126 (65) (0) GOTO 133
127 (65) (0) IF U >= 16 THEN 132
128 (65) (0) LET Z = 19
129 (65) (0) IF FNA(0) <> 8 THEN 131
130 (65) (0) LET Z = 11
131 (65) (0) GOTO 133
132 (65) (0) LET Z = 2
133 (65) (1) LET K = 0
134 (65) (1) GOSUB 305
135 (65) (1) IF T <> .5 THEN 145
136 (65) (0) IF V = 7 THEN 140
137 (65) (0) IF I <> 6 THEN 140
138 (65) (0) PRINT "I'LL CHECK"
139 (65) (0) GOTO 146
140 (65) (0) LET V = Z + FNA(0)
141 (65) (0) GOSUB 348
142 (65) (0) PRINT "I'LL BET" V
143 (65) (0) LET K = V
144 (65) (0) GOSUB 306
145 (65) (1) GOSUB 65
146 (65) (0) PRINT
147 (65) (0) PRINT "NOW WE COMPARE HANDS"
148 (65) (0) LET J$ = H$
149 (65) (0) LET K$ = I$
150 (65) (0) PRINT "MY HAND:"
151 (65) (0) LET N = 6
152 (65) (0) GOSUB 185
153 (65) (0) LET N = 1
154 (65) (0) GOSUB 217
155 (65) (0) PRINT
156 (65) (0) PRINT "Y0U HAVE ";
157 (65) (0) LET K = D
158 (65) (0) GOSUB 369
159 (65) (0) LET H$ = J$
160 (65) (0) LET I$ = K$
161 (65) (0) LET K = M
162 (65) (0) PRINT "AND I HAVE:"
163 (65) (0) GOSUB 369
164 (65) (0) IF B > U THEN 67
165 (65) (0) IF U > B THEN 78
166 (65) (0) IF H$ = "A FLUS" THEN 170
167 (65) (0) PRINT "THE HAND IS DRAWN"
168 (65) (0) PRINT "ALL $" P " REMAIN IN THE POT"
169 (65) (0) GOTO 14
170 (65) (0) IF FNB(M) > FNB(D) THEN 67
171 (65) (0) IF FNB(D) > FNB(M) THEN 78
172 (65) (0) GOTO 167
173 (173) (3) LET Z = Z + 1
174 (174) (458) LET A(Z) = INT(1000 * RND(0))
175 (174) (458) IF INT(A(Z) / 100) > 3 THEN 174
176 (174) (176) IF A(Z) - 100 * INT(A(Z) / 100) > 12 THEN 174
177 (174) (23) FOR K = 1 TO Z - 1
178 (174) (123) IF A(Z) = A(K) THEN 174
179 (174) (125) NEXT K
180 (174) (23) IF Z <= 10 THEN 184
181 (174) (3) LET N = A(U)
182 (174) (3) LET A(U) = A(Z)
183 (174) (3) LET A(Z) = N
184 (174) (23) RETURN
185 (185) (3) FOR Z = N TO N + 4
186 (185) (15) PRINT Z "-  ";
187 (185) (15) GOSUB 195
188 (185) (15) PRINT " OF";
189 (185) (15) GOSUB 207
190 (185) (15) IF Z / 2 <> INT(Z / 2) THEN 192
191 (185) (6) PRINT
192 (185) (15) NEXT Z
193 (185) (3) PRINT
194 (185) (3) RETURN
195 (195) (15) LET K = FNB(A(Z))
196 (195) (15) IF K <> 9 THEN 198
197 (195) (0) PRINT "JACK";
198 (195) (15) IF K <> 10 THEN 200
199 (195) (5) PRINT "QUEEN";
200 (195) (15) IF K <> 11 THEN 202
201 (195) (1) PRINT "KING";
202 (195) (15) IF K <> 12 THEN 204
203 (195) (2) PRINT "ACE";
204 (195) (15) IF K >= 9 THEN 206
205 (195) (7) PRINT K + 2;
206 (195) (15) RETURN
207 (207) (15) LET K = INT(A(Z) / 100)
208 (207) (15) IF K <> 0 THEN 210
209 (207) (4) PRINT " CLUBS",
210 (207) (15) IF K <> 1 THEN 212
211 (207) (3) PRINT " DIAMONDS",
212 (207) (15) IF K <> 2 THEN 214
213 (207) (5) PRINT " HEARTS",
214 (207) (15) IF K <> 3 THEN 216
215 (207) (3) PRINT " SPADES",
216 (207) (15) RETURN
217 (217) (3) LET U = 0
218 (217) (3) FOR Z = N TO N + 4
219 (217) (15) LET B(Z) = FNB(A(Z))
220 (217) (15) IF Z = N + 4 THEN 223
221 (217) (12) IF INT(A(Z) / 100) <> INT(A(Z + 1) / 100) THEN 223
222 (217) (1) LET U = U + 1
223 (217) (15) NEXT Z
224 (217) (3) IF U <> 4 THEN 231
225 (217) (0) LET X = 11111
226 (217) (0) LET D = A(N)
227 (217) (0) LET H$ = "A FLUS"
228 (217) (0) LET I$ = "H IN"
229 (217) (0) LET U = 15
230 (217) (0) RETURN
231 (217) (3) FOR Z = N TO N + 3
232 (217) (12) FOR K = Z + 1 TO N + 4
233 (217) (30) IF B(Z) <= B(K) THEN 239
234 (217) (7) LET X = A(Z)
235 (217) (7) LET A(Z) = A(K)
236 (217) (7) LET B(Z) = B(K)
237 (217) (7) LET A(K) = X
238 (217) (7) LET B(K) = A(K) - 100 * INT(A(K) / 100)
239 (217) (30) NEXT K
240 (217) (12) NEXT Z
241 (217) (3) LET X = 0
242 (217) (3) FOR Z = N TO N + 3
243 (217) (12) IF B(Z) <> B(Z + 1) THEN 247
244 (217) (1) LET X = X + 11 * 10 ^ (Z - N)
245 (217) (1) LET D = A(Z)
246 (217) (1) GOSUB 276
247 (217) (12) NEXT Z
248 (217) (3) IF X <> 0 THEN 262
249 (217) (2) IF B(N) + 3 <> B(N + 3) THEN 252
250 (217) (0) LET X = 1111
251 (217) (0) LET U = 10
252 (217) (2) IF B(N + 1) + 3 <> B(N + 4) THEN 262
253 (217) (0) IF U <> 10 THEN 260
254 (217) (0) LET U = 14
255 (217) (0) LET H$ = "STRAIG"
256 (217) (0) LET I$ = "HT"
257 (217) (0) LET X = 11111
258 (217) (0) LET D = A(N + 4)
259 (217) (0) RETURN
260 (217) (0) LET U = 10
261 (217) (0) LET X = 11110
262 (217) (3) IF U >= 10 THEN 269
263 (217) (2) LET D = A(N + 4)
264 (217) (2) LET H$ = "SCHMAL"
265 (217) (2) LET I$ = "TZ. "
266 (217) (2) LET U = 9
267 (217) (2) LET X = 11000
268 (217) (2) GOTO 274
269 (217) (1) IF U <> 10 THEN 272
270 (217) (0) IF I = 1 THEN 274
271 (217) (0) GOTO 275
272 (217) (1) IF U > 12 THEN 275
273 (217) (1) IF FNB(D) > 6 THEN 275
274 (217) (3) LET I = 6
275 (217) (3) RETURN
276 (276) (1) IF U >= 11 THEN 281
277 (276) (1) LET U = 11
278 (276) (1) LET H$ = "A PAIR"
279 (276) (1) LET I$ = " OF "
280 (276) (1) RETURN
281 (276) (0) IF U < 11 THEN 291
282 (276) (0) IF B(Z) <> B(Z - 1) THEN 287
283 (276) (0) LET H$ = "THREE"
284 (276) (0) LET I$ = " "
285 (276) (0) LET U = 13
286 (276) (0) RETURN
287 (276) (0) LET H$ = "TWO P"
288 (276) (0) LET I$ = "AIR. "
289 (276) (0) LET U = 12
290 (276) (0) RETURN
291 (276) (0) IF U <> 12 THEN 296
292 (276) (0) LET U = 16
293 (276) (0) LET H$ = "FULL H"
294 (276) (0) LET I$ = "OUSE. "
295 (276) (0) RETURN
296 (276) (0) IF B(Z) <> B(Z + 1) THEN 301
297 (276) (0) LET U = 17
298 (276) (0) LET H$ = "FOUR"
299 (276) (0) LET I$ = " "
300 (276) (0) RETURN
301 (276) (0) LET U = 6
302 (276) (0) LET H$ = "FULL H"
303 (276) (0) LET I$ = "OUSE. "
304 (276) (0) RETURN
305 (305) (3) LET G = 0
306 (305) (6) PRINT "WHAT IS YOUR BET";
307 (305) (6) INPUT T
308 (305) (6) IF T - INT(T) = 0 THEN 314
309 (305) (0) IF K <> 0 THEN 312
310 (305) (0) IF G <> 0 THEN 312
311 (305) (0) IF T = .5 THEN 341
312 (305) (0) PRINT "NO SMALL CHANGE, PLEASE"
313 (305) (0) GOTO 306
314 (305) (6) IF S - G - T > 0 THEN 317
315 (305) (0) GOSUB 383
316 (305) (0) GOTO 306
317 (305) (6) IF T <> 0 THEN 320
318 (305) (0) LET I = 3
319 (305) (0) GOTO 338
320 (305) (6) IF G + T >= K THEN 323
321 (305) (1) PRINT "IF YOU CAN'T SEE MY BET, THEN FOLD"
322 (305) (1) GOTO 306
323 (305) (5) LET G = G + T
324 (305) (5) IF G = K THEN 338
325 (305) (4) IF Z <> 1 THEN 342
326 (305) (2) IF G > 5 THEN 330
327 (305) (0) IF Z >= 2 THEN 335
328 (305) (0) LET V = 5
329 (305) (0) GOTO 342
330 (305) (2) IF Z = 1 THEN 332
331 (305) (0) IF T <= 25 THEN 335
332 (305) (2) LET I = 4
333 (305) (2) PRINT "I FOLD"
334 (305) (2) RETURN
335 (305) (0) IF Z = 2 THEN 343
336 (348) (0) PRINT "I'LL SEE YOU"
337 (348) (0) LET K = G
338 (348) (1) LET S = S - G
339 (348) (1) LET C = C - K
340 (348) (1) LET P = P + G + K
341 (348) (1) RETURN
342 (305) (2) IF G > 3 * Z THEN 335
343 (305) (2) LET V = G - K + FNA(0)
344 (305) (2) GOSUB 348
345 (305) (2) PRINT "I'LL SEE YOU, AND RAISE Y0U"; V
346 (305) (2) LET K = G + V
347 (305) (2) GOTO 306
348 (348) (3) IF C - G - V > 0 THEN 366
349 (348) (0) IF G <> 0 THEN 352
350 (348) (0) LET V = C
351 (348) (0) RETURN
352 (348) (0) IF C - G >= 0 THEN 336
353 (348) (0) IF O / 2 <> INT(O / 2) THEN 360
354 (348) (0) PRINT "WOULD YOU LIKE TO BUY BACK YOUR WATCH FOR $50";
355 (348) (0) INPUT J$
356 (348) (0) IF J$ = "NO" THEN 360
357 (348) (0) LET C = C - 50
358 (348) (0) LET O = O / 2
359 (348) (0) RETURN
360 (348) (0) IF O / 3 <> INT(O / 3) THEN 367
361 (348) (0) PRINT "WQULD YOU LIKE TO BUY BACK YOUR TIE TACK FOR $50";
362 (348) (0) INPUT J$
363 (348) (0) IF J$ = "NO" THEN 367
364 (348) (0) LET C = C - 50
365 (348) (0) LET O = O / 3
366 (348) (3) RETURN
367 (348) (0) PRINT "I'M BUSTED. CONGRATULATIONS"
368 (348) (0) STOP
369 (369) (0) PRINT H$; I$;
370 (369) (0) IF H$ = "A FLUS" THEN 375
371 (369) (0) LET K = INT(K / 100)
372 (369) (0) GOSUB 208
373 (369) (0) PRINT
374 (369) (0) RETURN
375 (369) (0) LET K = FNB(K)
376 (369) (0) GOSUB 196
377 (369) (0) IF H$ = "SCHMAL" THEN 379
378 (369) (0) IF H$ <> "STRAIG" THEN 381
379 (369) (0) PRINT " HIGH"
380 (369) (0) RETURN
381 (369) (0) PRINT "S"
382 (369) (0) RETURN
383 (383) (0) PRINT
384 (383) (0) PRINT "YOU CAN'T BET WHAT YOU HAVEN'T GOT"
385 (383) (0) IF O / 2 = INT(O / 2) THEN 397
386 (383) (0) PRINT "WOULD YOU LIKE TO SELL YOUR WATCH";
387 (383) (0) INPUT J$
388 (383) (0) IF J$ = "NO" THEN 397
389 (383) (0) IF FNA(01) >= 7 THEN 393
390 (383) (0) PRINT "I'LL GIVE YOU $75 FOR IT"
391 (383) (0) LET S = S + 75
392 (383) (0) GOTO 395
393 (383) (0) PRINT "THAT'S A PRETTY CRUMMY WATCH - I'LL GIVE YOU $25"
394 (383) (0) LET S = S + 25
395 (383) (0) LET O = O * 2
396 (383) (0) RETURN
397 (383) (0) IF O / 3 = INT(O / 3) THEN 409
398 (383) (0) PRINT "WILL YOU PART WITH THAT DIAMOND TIE TACK";
399 (383) (0) INPUT J$
400 (383) (0) IF J$ = "NO" THEN 408
401 (383) (0) IF FNA(0) >= 6 THEN 405
402 (383) (0) PRINT "YOU ARE NOW $100 RICHER"
403 (383) (0) LET S = S + 100
404 (383) (0) GOTO 407
405 (383) (0) PRINT "IT'S PASTE. $25"
406 (383) (0) LET S = S + 25
407 (383) (0) LET O = O * 3
408 (383) (0) RETURN
409 (383) (0) PRINT "YOUR WAD IS SHOT, SO LONG, SUCKER"
410 (383) (1) END

