DO YOU WANT INSTRUCTIONS? NO
DO YOU WANT TO MOVE FIRST? YES
 
YOUR MOVE? 222
MACHINE MOVES TO 111  
YOUR MOVE? 211
MACHINE MOVES TO 411  
YOUR MOVE? 233
NICE TRY MACHINE MOVES TO 244  
YOUR MOVE? 122
MACHINE MOVES TO 414  
YOUR MOVE? 422
NICE TRY MACHINE MOVES TO 322  
YOUR MOVE? 121
MACHINE MOVES TO 114  
YOUR MOVE? 323
NICE TRY MACHINE MOVES TO 424  
YOUR MOVE? 413
NICE TRY MACHINE MOVES TO 143  
YOUR MOVE? 444
MACHINE MOVES TO 141  
YOUR MOVE? 142
MACHINE TAKES 112  
YOUR MOVE? 113
MACHINE TAKES 223  
YOUR MOVE? 141
THAT SQUARE IS USED, TRY AGAIN
 
YOUR MOVE? 332
MACHINE MOVES TO 441  
YOUR MOVE? 241
LET'S SEE YOU GET OUT OF THIS! MACHINE MOVES TO 421  
YOUR MOVE? 431
MACHINE MOVES TO 124 , AND WINS AS FOLLOWS
 421  322  223  124  
DO YOU WANT TO TRY ANOTHER GAME? NO
STOP in line 520

1 (0) REM "  QUBIC-  "
5 (1) PRINT "DO YOU WANT INSTRUCTIONS";
6 (1) INPUT C$
7 (1) IF C$ = "NO" THEN 20
8 (0) IF C$ = "YES" THEN 13
9 (0) PRINT "INCORRECT ANSWER. PLEASE TYPE 'YES' OR 'NO'";
10 (0) GOTO 6
13 (0) PRINT "THE GAME IS TIC-TAC-TOE IN A 4 X 4 X 4 CUBE."
14 (0) PRINT "EACH MOVE IS INDICATED BY A 3 DIGIT NUMBER, WITH EACH"
15 (0) PRINT "DIGIT BETWEEN 1 AND 4 INCLUSIVE. THE DIGITS INDICATE THE"
16 (0) PRINT "LEVEL, COLUMN, AND ROW, RESPECTIVELY, OF THE OCCUPIED PLACE,"
20 (1) DIM X(64), L(76), M(76, 4), Y(16)
21 F(I:21) (1) FOR I = 1 TO 16
22 F(I:21) (16) READ Y(I)
23 F(I:21) (16) NEXT I
24 F(I:24) (1) FOR I = 1 TO 76
25 F(I:24,J:25) (76) FOR J = 1 TO 4
26 F(I:24,J:25) (304) READ M(I, J)
27 F(I:24,J:25) (304) NEXT J
28 F(I:24) (76) NEXT I
35 F(I:35) (1) FOR I = 1 TO 64
40 F(I:35) (64) LET X(I) = 0
50 F(I:35) (64) NEXT I
54 (1) LET Z = 1
55 (1) PRINT "DO YOU WANT TO MOVE FIRST";
60 (1) INPUT S$
66 (1) IF S$ = "NO" THEN 110
67 (1) IF S$ = "YES" THEN 70
68 (0) PRINT "INCORRECT ANSWER. PLEASE TYPE 'YES' OR 'NO'";
69 (0) GOTO 60
70 (15) PRINT " "
72 (15) PRINT "YOUR MOVE";
80 (15) INPUT J1
85 (15) GOSUB 1800
90 (15) LET K1 = INT(J1 / 100)
95 (15) LET J2 = (J1 - K1 * 100)
96 (15) LET K2 = INT(J2 / 10)
97 (15) LET K3 = J1 - K1 * 100 - K2 * 10
98 (15) LET M = 16 * K1 + 4 * K2 + K3 - 20
99 (15) IF X(M) = 0 THEN 109
100 (1) PRINT "THAT SQUARE IS USED, TRY AGAIN"
101 (1) GOTO 70
109 (14) LET X(M) = 1
110 (14) GOSUB 1050
180 F(J:180) (14) FOR J = 1 TO 3
190 F(J:180,I:190) (41) FOR I = 1 TO 76
200 F(J:180,I:190) (3007) IF J = 1 THEN 210
201 F(J:180,I:190) (1943) IF J = 2 THEN 220
203 F(J:180,I:190) (885) IF J = 3 THEN 235
205 F(J:180,I:190) (3002) NEXT I
206 F(J:180) (36) NEXT J
207 (9) GOTO 400
210 (1064) IF L(I) <> 4 THEN 205
211 (0) PRINT "YOU WIN AS FOLLOWS";
212 F(J:212) (0) FOR J = 1 TO 4
213 F(J:212) (0) LET M = M(I, J)
214 F(J:212) (0) GOSUB 1000
216 F(J:212) (0) NEXT J
217 (0) GOTO 500
220 (1058) IF L(I) <> 15 THEN 205
221 F(J:221) (1) FOR J = 1 TO 4
222 F(J:221) (4) LET M = M(I, J)
223 F(J:221) (4) IF X(M) <> 0 THEN 227
224 F(J:221) (1) LET X(M) = 5
225 F(J:221) (1) PRINT "MACHINE MOVES TO";
226 F(J:221) (1) GOSUB 1000
227 F(J:221) (4) NEXT J
228 (1) PRINT ", AND WINS AS FOLLOWS"
229 F(J:229) (1) FOR J = 1 TO 4
230 F(J:229) (4) LET M = M(I, J)
231 F(J:229) (4) GOSUB 1000
233 F(J:229) (4) NEXT J
234 (1) GOTO 500
235 (885) IF L(I) <> 3 THEN 205
236 (4) PRINT "NICE TRY MACHINE MOVES TO";
237 F(J:237) (4) FOR J = 1 TO 4
238 F(J:237) (15) LET M = M(I, J)
239 F(J:237) (15) IF X(M) <> 0 THEN 245
240 F(J:237) (4) LET X(M) = 5
241 F(J:237) (4) GOSUB 1000
243 F(J:237) (4) GOTO 70
245 F(J:237) (11) NEXT J
248 (0) GOTO 400
250 F(I:250) (8) FOR I = 1 TO 76
251 F(I:250) (608) LET L(I) = X(M(I, 1)) + X(M(I, 2)) + X(M(I, 3)) + X(M(I, 4))
252 F(I:250) (608) LET L = L(I)
255 F(I:250) (608) IF L < 2 THEN 290
260 F(I:250) (238) IF L >= 3 THEN 290
265 F(I:250) (13) IF L > 2 THEN 1600
270 F(I:250,J:270) (13) FOR J = 1 TO 4
275 F(I:250,J:270) (52) IF X(M(I, J)) <> 0 THEN 285
280 F(I:250,J:270) (26) LET X(M(I, J)) = 1 / 8
285 F(I:250,J:270) (52) NEXT J
290 F(I:250) (608) NEXT I
295 (8) GOSUB 1050
300 F(I:300) (8) FOR I = 1 TO 76
305 F(I:300) (608) IF L(I) = 1 / 2 THEN 1700
310 F(I:300) (608) IF L(I) = 1 + 3 / 8 THEN 1700
315 F(I:300) (608) NEXT I
320 (8) GOTO 1300
360 (6) LET Z = 1
362 (21) IF X(Y(Z)) = 0 THEN 380
365 (15) LET Z = Z + 1
368 (15) IF Z <> 17 THEN 362
375 (0) GOTO 1200
380 (6) LET M = Y(Z)
381 (6) LET X(M) = 5
385 (6) PRINT "MACHINE MOVES TO";
389 (6) GOSUB 1000
390 (6) GOTO 70
400 (9) LET X = X
410 F(I:410) (9) FOR I = 1 TO 76
412 F(I:410) (678) LET L(I) = X(M(I, 1)) + X(M(I, 2)) + X(M(I, 3)) + X(M(I, 4))
415 F(I:410) (678) LET L = L(I)
420 F(I:410) (678) IF L < 10 THEN 455
425 F(I:410) (70) IF L >= 11 THEN 455
430 F(I:410) (32) IF L > 10 THEN 1600
435 F(I:410,J:435) (31) FOR J = 1 TO 4
440 F(I:410,J:435) (124) IF X(M(I, J)) <> 0 THEN 450
445 F(I:410,J:435) (62) LET X(M(I, J)) = 1 / 8
450 F(I:410,J:435) (124) NEXT J
455 F(I:410) (677) NEXT I
470 (8) GOSUB 1050
475 F(I:475) (8) FOR I = 1 TO 76
480 F(I:475) (608) IF L(I) = 0.5 THEN 1700
485 F(I:475) (608) IF L(I) = 5 + 3 / 8 THEN 1700
490 F(I:475) (608) NEXT I
492 (8) GOSUB 1800
493 (8) GOTO 250
500 (1) PRINT " "
505 (1) PRINT "DO YOU WANT TO TRY ANOTHER GAME";
510 (1) INPUT X$
515 (1) IF X$ = "YES" THEN 35
516 (1) IF X$ = "NO" THEN 520
517 (0) PRINT "INCORRECT ANSWER. PLEASE TYPE 'YES' OR 'NO'";
518 (0) GOTO 510
520 (1) STOP
1000 G(1000) (18) LET K1 = INT((M - 1) / 16) + 1
1010 G(1000) (18) LET J2 = M - 16 * (K1 - 1)
1030 G(1000) (18) LET K2 = INT((J2 - 1) / 4) + 1
1035 G(1000) (18) LET K3 = M - (K1 - 1) * 16 - (K2 - 1) * 4
1040 G(1000) (18) LET M = K1 * 100 + K2 * 10 + K3
1042 G(1000) (18) PRINT M;
1045 G(1000) (18) RETURN
1050 G(1050) F(S:1050) (30) FOR S = 1 TO 76
1060 G(1050) F(S:1050) (2280) LET J1 = M(S, 1)
1070 G(1050) F(S:1050) (2280) LET J2 = M(S, 2)
1080 G(1050) F(S:1050) (2280) LET J3 = M(S, 3)
1090 G(1050) F(S:1050) (2280) LET J4 = M(S, 4)
1100 G(1050) F(S:1050) (2280) LET L(S) = X(J1) + X(J2) + X(J3) + X(J4)
1110 G(1050) F(S:1050) (2280) NEXT S
1120 G(1050) (30) RETURN
1200 F(I:1200) (0) FOR I = 1 TO 64
1210 F(I:1200) (0) IF X(I) <> 0 THEN 1250
1220 F(I:1200) (0) LET X(I) = 5
1225 F(I:1200) (0) LET M = I
1226 F(I:1200) (0) PRINT "MACHINE LIKES";
1227 F(I:1200) (0) GOSUB 1000
1228 F(I:1200) (0) PRINT " "
1230 F(I:1200) (0) GOTO 70
1250 F(I:1200) (0) NEXT I
1252 (0) PRINT "THE GAME IS A DRAW"
1255 (0) GOTO 500
1300 F(K:1300) (8) FOR K = 1 TO 18
1305 F(K:1300) (121) LET P = 0
1310 F(K:1300,I:1310) (121) FOR I = 4 * K - 3 TO 4 * K
1315 F(K:1300,I:1310,J:1315) (484) FOR J = 1 TO 4
1320 F(K:1300,I:1310,J:1315) (1936) LET P = P + X(M(I, J))
1325 F(K:1300,I:1310,J:1315) (1936) NEXT J
1330 F(K:1300,I:1310) (484) NEXT I
1345 F(K:1300) (121) IF P < 4 THEN 1390
1350 F(K:1300) (83) IF P < 5 THEN 1400
1355 F(K:1300) (83) IF P < 9 THEN 1390
1360 F(K:1300) (50) IF P < 10 THEN 1400
1390 F(K:1300) (119) NEXT K
1395 (6) GOSUB 1800
1396 (6) GOTO 360
1400 (2) LET S = 1 / 8
1405 F(I:1405) (3) FOR I = 4 * K - 3 TO 4 * K
1410 F(I:1405) (7) GOTO 1703
1415 F(I:1405) (5) NEXT I
1420 (1) LET S = 0
1425 (1) GOTO 1405
1500 (0) DATA 1, 49, 52, 4, 13, 61, 64, 16, 22, 39, 23, 38, 26, 42, 27, 43
1510 (0) DATA 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20
1520 (0) DATA 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38
1521 (0) DATA 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56
1522 (0) DATA 57, 58, 59, 60, 61, 62, 63, 64
1523 (0) DATA 1, 17, 33, 49, 5, 21, 37, 53, 9, 25, 41, 57, 13, 29, 45, 61
1524 (0) DATA 2, 18, 34, 50, 6, 22, 38, 54, 10, 26, 42, 58, 14, 30, 46, 62
1525 (0) DATA 3, 19, 35, 51, 7, 23, 39, 55, 11, 27, 43, 59, 15, 31, 47, 63
1527 (0) DATA 4, 20, 36, 52, 8, 24, 40, 56, 12, 28, 44, 60, 16, 32, 48, 64
1529 (0) DATA 1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61
1532 (0) DATA 2, 6, 10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58, 62
1534 (0) DATA 3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51, 55, 59, 63
1536 (0) DATA 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64
1538 (0) DATA 1, 6, 11, 16, 17, 22, 27, 32, 33, 38, 43, 48, 49, 54, 59, 64
1540 (0) DATA 13, 10, 7, 4, 29, 26, 23, 20, 45, 42, 39, 36, 61, 58, 55, 52
1542 (0) DATA 1, 21, 41, 61, 2, 22, 42, 62, 3, 23, 43, 63, 4, 24, 44, 64
1544 (0) DATA 49, 37, 25, 13, 50, 38, 26, 14, 51, 39, 27, 15, 52, 40, 28, 16
1546 (0) DATA 1, 18, 35, 52, 5, 22, 39, 56, 9, 26, 43, 60, 13, 30, 47, 64
1548 (0) DATA 49, 34, 19, 4, 53, 38, 23, 8, 57, 42, 27, 12, 61, 46, 31, 16
1550 (0) DATA 1, 22, 43, 64, 16, 27, 38, 49, 4, 23, 42, 61, 13, 26, 39, 52
1600 F(J:1600) (1) FOR J = 1 TO 4
1605 F(J:1600) (1) IF X(M(I, J)) <> 1 / 8 THEN 1650
1610 F(J:1600) (1) LET X(M(I, J)) = 5
1615 F(J:1600) (1) IF L(I) < 5 THEN 1625
1620 F(J:1600) (1) PRINT "LET'S SEE YOU GET OUT OF THIS! MACHINE MOVES TO";
1622 F(J:1600) (1) GOTO 1626
1625 F(J:1600) (0) PRINT "YOU FOX. JUST IN THE NICK OF TIME, MACHINE MOVES TO";
1626 F(J:1600) (1) LET M = M(I, J)
1630 F(J:1600) (1) GOSUB 1000
1640 F(J:1600) (1) GOTO 70
1650 F(J:1600) (0) NEXT J
1660 (0) PRINT "MACHINE CONCEDES THIS GAME."
1665 (0) GOTO 500
1700 (0) LET S = 1 / 8
1703 (7) IF I - INT(I / 4) * 4 > 1 THEN 1715
1705 (4) LET A = 1
1710 (4) GOTO 1720
1715 (3) LET A = 2
1720 F(J:1720) (7) FOR J = A TO 5 - A STEP 5 - 2 * A
1725 F(J:1720) (12) IF X(M(I, J)) = S THEN 1750
1730 F(J:1720) (10) NEXT J
1735 (5) GOTO 1415
1750 (2) LET X(M(I, J)) = 5
1755 (2) LET M = M(I, J)
1760 (2) PRINT "MACHINE TAKES";
1770 (2) GOSUB 1000
1780 (2) GOTO 70
1800 G(1800) F(I:1800) (29) FOR I = 1 TO 64
1810 G(1800) F(I:1800) (1856) IF X(I) <> 1 / 8 THEN 1850
1815 G(1800) F(I:1800) (86) LET X(I) = 0
1850 G(1800) F(I:1800) (1856) NEXT I
1860 G(1800) (29) RETURN
2000 (0) END

