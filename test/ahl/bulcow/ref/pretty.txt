5 GOSUB 500
10 DIM D(10, 4), B(10), C(18), G(10)
 WARNING: Inconsistent GOSUB target (500, 400)
15 RANDOMIZE : PRINT : PRINT : PRINT
20 LET A = 0 : GOTO 200
30 PRINT : PRINT : PRINT : LET J = 0
35 PRINT "YOUR GUESS"; : INPUT N : LET N = (N + .1) / 100000
40 FOR I = 0 TO 4 : LET G(I) = INT(10 * N) : LET N = 10 * N - INT(10 * N)
41 FOR K = 0 TO I - 1 : IF G(I) = G(K) GOTO 170
42 NEXT K
43 NEXT I
45 LET P = 4 : LET A = 0 : GOSUB 300
50 PRINT V "BULL"; : IF V <> 1 THEN PRINT "S";
55 IF V = 5 THEN PRINT " - YOU WIN" : GOTO 20
60 PRINT W - V "COW"; : IF W <> V + 1 THEN PRINT "S";
65 IF J = 0 THEN LET A = 1 : GOTO 200
68 GOSUB 400
70 PRINT " - MY GUESS IS ";
75 FOR I = 0 TO 4 : PRINT CHR$(D(J, I) + 48); : NEXT I
80 PRINT " MY SCORE "; : INPUT B(J), C(J) : LET C(J) = C(J) + B(J)
81 IF B(J) > -1 THEN IF B(J) < 6 THEN IF C(J) < 6 THEN IF C(J) - B(J) > -1 GOTO 80
 WARNING: Line exceeds PRETTY width limit 72
82 PRINT " - RIDICULOUS! !"; : GOTO 70
83 IF B(J) = 4 THEN IF C(J) = 5 GOTO 82
85 IF B(J) = 5 THEN PRINT " - I WIN - MY NUMBER WAS"; : GOTO 100
98 GOTO 35
100 FOR I = 0 TO 4 : PRINT CHR$(D(0, I) + 48); : NEXT I
110 GOTO 20
150 PRINT : PRINT "YOU HAVE GIVEN ME IMPOSSIBLE SCORES - GAME SPOILED" : GOTO 5
 WARNING: Line exceeds PRETTY width limit 72
170 PRINT "REPEATED DIGITS NOT ALLOWED" : GOTO 35
200 FOR P = 0 TO 4
210 LET D(A, P) = INT(10 * RND(1))
220 FOR I = 0 TO P - 1 : IF D(A, I) = D(A, P) GOTO 210
230 NEXT I
240 NEXT P
250 IF A = 0 GOTO 30
260 LET J = 1 : GOTO 70
300 LET V = 0 : LET W = 0
310 FOR I = 0 TO P : IF D(A, I) = G(I) THEN LET V = V + 1
320 FOR K = 0 TO 4 : IF D(A, K) = G(I) THEN LET W = W + 1
330 NEXT K
340 NEXT I
350 RETURN
400 LET P = 0
405 LET G(P) = D(J, P)
410 FOR I = 0 TO P - 1 : IF G(I) = G(P) GOTO 430
415 NEXT I
420 FOR A = 1 TO J : GOSUB 300
425 IF V <= B(A) THEN IF W <= C(A) THEN IF 4 - P >= C(A) - W THEN IF 4 - P >= B(A) - V GOTO 440
 WARNING: Line exceeds PRETTY width limit 72
430 LET G(P) = G(P) + 3 : IF G(P) > 9 THEN LET G(P) = G(P) - 10
432 IF P = 0 THEN IF G(P) = D(1, 0) GOTO 150
435 IF G(P) <> D(J, P) GOTO 410
440 LET P = P - 1 : IF P < 0 THEN GOTO 150
445 GOTO 430
448 NEXT A
450 LET P = P + 1 : IF P < 5 GOTO 405
455 LET J = J + 1
460 FOR I = 0 TO 4 : LET D(J, I) = G(I) : NEXT I
465 RETURN
500 PRINT : PRINT : PRINT "                 BRADFORD UNIVERSITY BULLS AND COWS GAME"
 WARNING: Line exceeds LIST width limit 72
 WARNING: Line exceeds PRETTY width limit 72
510 GOTO 10
999 END

