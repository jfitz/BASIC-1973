1 ! BY JEFF DAL TON* CLASS OF '74* NORTHFI ELD MOUNT HERMON SCHOOL 

2 ! THIS PROGRAM PLAYS THE GAME 'HEXAPAWN' BY A METHOD OUTLINED IN 

'MATHEMATICAL GAMES' IN MARCH 1962 SCIENTIFIC AMERICAN. 

3 ! THE PROGRAM LEARNS BY ELIMINATION OF BAD MOVES* ALL POSITIONS 

ENCOUNTERED BY THE PROGRAM AND THE ACCEPTABLE MOVES FROM THEM 
ARE STORED IN PSUX) 

4 I WHEN THE PROGRAM ENCOUNTERS AN UNFAMILIAR POSITION* THE POSITION 

AND ALL LEGAL MOVES FROM IT ARE ADDED TO THE LIST. 

5 ! IF THE PROGRAM LOSES A GAME* IT ERASES THE MOVE THAT LED TO DEFEAT. 

IF IT HITS A POSITION FROM WHICH ALL MOVES HAVE BEEN DELETED 

&lt; THEY ALL LED TO DEFEAT )* IT ERASES THE MOVE THAT GOT 

IT HERE AND RESIGNS. 
18 INPUT "INSTRUCTIONS"; CS: IF LEFTCCS* 1X)&lt;&gt; "Y" THEN 118 
28 A: A* "THIS PROGRAM PLAYS THE GAME OF HEXAPAWN."!* 

"HEXAPAWN IS PLAYED WITH CHESS PAWNS ON A 3 BY 3 BOARD. THE PAWNS ARE": A 
"MOVED AS IN CHESS - ONE SPACE FORWARD TO AN EMPTY SPACE OR ONE SPACE" 
38 A-FORWARD AND DIAGONALLY TO CAPTURE AN OPPOSING MAN. ": A: ACHRS&lt;9X); 
"0 THE BOARD* YOUR PAWNS ARE '0', THE COMPUTER'S PAWNS ARE '«'":A 
"AND EMPTY SQUARES ARE '-*. TO ENTER A MOVE* TYPE THE NUMBER OF THE" 
48 A-SQUARE YOU WILL MOVE FROM FOLLOWED BY THE NUMBER OF THE SQUARE": A 
"YOU WILL MOVE TO. (THE NUMBERS ARE SEPARATED BY A COMMA. )"*A 
58 A" THE PROGRAM STARTS A SERI S OF GAMES KNOWING ONLY WHEN THE"* A 
"GAME IS WON (A DRAW IS IMPOSSIBLE) AND HOW TO MOVE. IT HAS NO":A 
"STRATEGY AT FIRST AND JUST MOVES RANDOMLY. HOWEVER* IT LEARNS" 
68 A-FROM EACH GAME. THUS* DEFEATING IT BECOMES MORE AND MORE": A 
-DIFFICULT. ALSO* TO HELP OFFSET YOUR INITIAL ADVANTAGE* YOU WILL": A 
"NOT BE TOLD HOW TO WIN THE GAME BUT MUST LEARN THIS BY PLAYING":A 
188 DEF FNC$CXS*XX*YS)«LEFT&lt;XS*XX-1X)+YS+RIGHT(X$*XX+LENCYS)) 
165 DEF FNNS&lt;XX): XS«NUMS(XX) : FNNS-MI D&lt;XS* 2X*LEN&lt;XS)-2X&gt; : FNEND 
118 DIM PS&lt;58X): RANDOMIZE: QX»8X: 

PRINT "SINCE I'M A GOOD SPORT* YOU'LL ALWAYS GO FIRST 
128 PX-8X: P$« "♦»»-— 000": A: A"NUMBERING: ": 

A"123": A"456": A"789": A 
198 DX--1X: QS»"0": GOSUB 2888: I F MS»"" THEN 

PRINT "YOU CAN'T MOVE. I WIN.": GOTO 518 
288 A: A-BOARD:": ALEFTCPS, 3X) : AMI DCPS* 4X* 3X) : ARI GHT(PS* 7X) : A 
218 INPUT "WHAT IS YOUR MOVE"; AX*BX: 

IF INSTR(1X*MS*FNNS&lt;AX) + FNN$&lt;BX))»8X THEN 

PRINT "ILLEGAL MOVE.": GOTO 218 
238 PS»FNCS&lt;FNCS&lt;PS*AX*"-")*BX*"0"&gt;: 

IF INSTR&lt; IX* PS* "»"&gt;» 8 X OR INSTR&lt; IX* PS* *0"X4X THEN 

PRINT "YOU WIN.": GOTO 588 
388 PX»PX+2X ! COMPUTER'S MOVE 

318 FOR CX-1X TO QX: CS*PS&lt;CX): IF VALCLEFTCCS* IX) )»PX AND 

MID&lt;CS*2X*9X)»P$ THEN MS»RIGHT&lt; CS* 1 IX) : GOTO 488 
328 NEXT CX: QS»"»": DX» 1 X: GOSUB 2888: CX»QX: 

IF MS»"" THEN PRINT "I CAN'T MOVE* YOU WIN.": GOTO 580 
488 IF MS»"" THEN PRINT "I RESIGN.": GOTO 588 
418 KS»LEFT&lt;MS*2X): MS*RIGHT&lt;MS* 3X&gt; : 

IF RND&gt;. 33333333 ANDMSo — THEN 418 
428 KX«CX: AX*VAL&lt;LEFT&lt;K$* 1 X)) : BX* VAL&lt; RIGHT &lt;KS* 2X) ) : 

PS»FNCS&lt;FNCS&lt;PS*AX*"-")*BX*"*") 
438 IF INSTR&lt;1X*PS* "0")»OX OR INSTRC7X* PS* "•") THEN 

PRINT "I WIN!": GOTO 518 
448 PRINT "I MOVE FROM" AX "TO" BX: GOTO 19 8 
508 V2X-W2X+1X: I X»INSTR( 1 1 X, PSCKX)*KS) : 

PS&lt;KX)»LEFT&lt;PS&lt;KX)*IX-1X)+RIGHTCPS&lt;KX)*IX+2X) IF IX: GOTO 528 
518 W1X-W1X+1X 
528 A: A"BOARD:": ALEFTCPS* 3X) : AMI D&lt;PS*4X* 3X) : ARI GHTCPS* 7X) : A: 

A "I HAVE WON" W1X "AND YOU HAVE WON" W2X "OF" W1X+W2X "GAMES" 
530 INPUT "ANOTHER GAME"; CS: IF CS»"NO" THEN 9999 ELSE 128 
908 ! DATA**» &lt;- OF MOVE IN GAME&gt;&lt;POSITION»&lt;LI ST OF MOVES&gt; 

IN &lt;P0SITI0N&gt;* -aBLANK* '-COMPUTER'S PAWN* 0*PLAYER*S PAWN 

&lt;LIST OF M0VES&gt; IS &lt;- MOVE FROM&gt;&lt;- MOVE TO&gt;&lt;LIST OF M0VES&gt; 
2888 MS»"" 

2818 FOR JX»1X TO 9X: I F MID&lt;PS* JX* 1XX&gt;QS THEN 2050 
2815 TX»JX+DX*3X: IF TX&lt;1X OR TX&gt;9X THEN 2825 
2828 IF MID&lt;PS*TX* 1X)»"-" THEN 

MS»MS+FNNSCJX)+FNNS&lt;TX) 
2825 TX»JX+DX*2X: IF TX&lt; 1 X OR TX&gt;9X OR 

(DX-1X AND CJX-1X OR JX»4X OR JX-7X)) OR 

&lt;DX— IX AND &lt;JX»3X OR JX=6X OR JX-9X)) THEN 2835 
2838 IF INSTRC lX*aS+"--*MID&lt;PS*TX* lX)) = qx THEN 

M$»MS+FNNSCJX)+FNNS(TX) 
2835 TX»JX+DX*4X: IF TX&lt; 1 X OR TX&gt;9X OR JX-3X OR JX-7X THEN 2058 
2848 IF INSTRC IX* QS+"-"*MIDCP$* TX* IX) )»8X THEN 

MS«MS+FNNSCJX) + FNNSCTX) 
2858 NEXT JX: IF DX»1X AND MS&lt;&gt;"" THEN QX-QX+IX: PS€QX)«FNNS(PX)+PS+MS 
2868 RETURN 
9999 END 

