THIS PROGRAM PLAYS NIM.
DO YOU WANT INSTRUCTIONS? YES

    NIM IS PLAYED BY TWO PEOPLE PLAYING ALTERNATELY, BEFORE
THE PLAY STARTS, AN ARBITRARY NUMBER OF STICKS OR OBJECTS IS
PUT INTO AN ARBITRARY NUMBER OF PILES, IN ANY DISTRIBUTION
WHATEVER, THEN EACH PLAYER IN HIS TURN REMOVES AS MANY
STICKS AS HE WISHES FROM ANY PILEBUT FROM ONLY ONE PILE,
AND AT LEAST ONE STICK, THE PLAYER WHO TAKES THE LAST STICK
IS THE WINNER.
    THIS PROGRAM ALLOWS YOU TO SET UP THE INITIAL ARRANGEMENT
OF PILES AND STICKS. IT WILL NOT ACCEPT MORE THAN TWENTY
PILES OR STICKS IN EACH PILE.

HOW MANY PILES? 3

HOW MANY STICKS IN PILE 1 ? 5
HOW MANY STICKS IN PILE 2 ? 4
HOW MANY STICKS IN PILE 3 ? 3

DO YOU WANT TO GO FIRST? YES

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 3 STICKS FROM PILE 3 .

PlLE NUMBER     STICKS LEFT
 1               4
 2               4

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

PlLE NUMBER     STICKS LEFT
 1               3
 2               3

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

PlLE NUMBER     STICKS LEFT
 1               2
 2               2

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

PlLE NUMBER     STICKS LEFT
 1               1
 2               1

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

I WON. DO YOU WANT TO PLAY AGAIN? NO
STOP in line 290

100.0 (1) REM THIS PROGRAM USES A STRATEGY AS PRESENTED IN 'GAMES OF FUN AND
105.0 (1) REM STRATEGY', A PUBLICATION OF THE MATHEMATICAL SERVICES DEPART-
110.0 (1) REM MENT OF COMPUTER CONTROL CO., INC.
115.0 (1) PRINT "THIS PROGRAM PLAYS NIM."
120.0 (1) PRINT "DO YOU WANT INSTRUCTIONS";
120.1 (1) INPUT Q$
125.0 (1) IF Q$ = "YES" THEN 135
125.1 (0) IF Q$ = "NO" THEN 190
130.0 (0) PRINT "TYPE YES OR NO."
130.1 (0) INPUT Q$
130.2 (0) GOTO 125
135.0 (1) PRINT
140.0 (1) PRINT "    NIM IS PLAYED BY TWO PEOPLE PLAYING ALTERNATELY, BEFORE"
145.0 (1) PRINT "THE PLAY STARTS, AN ARBITRARY NUMBER OF STICKS OR OBJECTS IS"
150.0 (1) PRINT "PUT INTO AN ARBITRARY NUMBER OF PILES, IN ANY DISTRIBUTION"
155.0 (1) PRINT "WHATEVER, THEN EACH PLAYER IN HIS TURN REMOVES AS MANY"
160.0 (1) PRINT "STICKS AS HE WISHES FROM ANY PILEBUT FROM ONLY ONE PILE,"
165.0 (1) PRINT "AND AT LEAST ONE STICK, THE PLAYER WHO TAKES THE LAST STICK"
170.0 (1) PRINT "IS THE WINNER."
175.0 (1) PRINT "    THIS PROGRAM ALLOWS YOU TO SET UP THE INITIAL ARRANGEMENT"
180.0 (1) PRINT "OF PILES AND STICKS. IT WILL NOT ACCEPT MORE THAN TWENTY"
185.0 (1) PRINT "PILES OR STICKS IN EACH PILE."
190.0 (1) RANDOM
195.0 (1) REM -------------------CONFIGURATION INPUT----------------------------
200.0 (1) DIM X(20, 4), S(20), L(20), S2(20), N2(4), C(20), S3(20), V(20)
205.0 (1) PRINT
205.1 (1) PRINT "HOW MANY PILES";
205.2 (1) INPUT P
205.3 (1) IF P > 20 THEN 215
210.0 (1) IF P > INT(P) THEN 215
210.1 (1) IF P <= 0 THEN 215
210.2 (1) GOTO 220
215.0 (0) PRINT "ILLEGAL PILE NUMBER. "
215.1 (0) PRINT
215.2 (0) GOTO 205
220.0 (1) PRINT
220.1 (1) FOR I = 1 TO P
225.0 (3) PRINT "HOW MANY STICKS IN PILE" I;
225.1 (3) INPUT L(I)
225.2 (3) IF L(I) > 20 THEN 235
230.0 (3) IF L(I) > INT(L(I)) THEN 235
230.1 (3) IF L(I) <= 0 THEN 235
230.2 (3) GOTO 240
235.0 (0) PRINT "ILLEGAL STICK NUMBER"
235.1 (0) PRINT
235.2 (0) GOTO 225
240.0 (3) NEXT I
245.0 (1) FOR I = 1 TO P
245.1 (3) S(I) = L(I)
245.2 (3) G = G + L(I)
245.3 (3) NEXT I
250.0 (1) PRINT
250.1 (1) PRINT "DO YOU WANT TO GO FIRST";
255.0 (1) INPUT Q$
255.1 (1) IF Q$ = "YES" THEN 340
255.2 (0) IF Q$ = "NO" THEN 390
260.0 (0) PRINT "TYPE YES OR NO."
260.1 (0) GOTO 255
265.0 (0) REM  CONTROL OF GAME REPEATS AND TESTS FOR END OF GAME- 
270.0 (10) IF G = 0 THEN 275
270.1 (9) IF F = 1 THEN 390
270.2 (4) GOTO 320
275.0 (1) IF F = 1 THEN 315
280.0 (1) PRINT
280.1 (1) PRINT "I WON. DO YOU WANT TO PLAY AGAIN";
285.0 (1) INPUT Q$
285.1 (1) IF Q$ = "NO" THEN 290
285.2 (0) IF Q$ = "YES" THEN 300
285.3 (0) GOTO 295
290.0 (1) STOP
295.0 (0) PRINT "TYPE YES OR NO."
295.1 (0) GOTO 285
300.0 (0) PRINT
300.1 (0) PRINT "SAME ARRANGEMENT";
305.0 (0) INPUT Q$
305.1 (0) IF Q$ = "NO" THEN 205
305.2 (0) IF Q$ = "YES" THEN 345
310.0 (0) PRINT "TYPE YES OR NO."
310.1 (0) GOTO 305
315.0 (0) PRINT
315.1 (0) PRINT "YOU WON, DO YOU WANT TO PLAY AGAIN";
315.2 (0) GOTO 285
320.0 (4) PRINT
320.1 (4) PRINT "PlLE NUMBER", "STICKS LEFT"
325.0 (4) FOR I = 1 TO P
325.1 (12) IF S(I) = 0 THEN 330
325.2 (8) PRINT I, S(I)
330.0 (12) NEXT I
335.0 (4) REM -------------------PLAYER'S MOVE-------------------------
340.0 (5) PRINT
340.1 (5) PRINT "WHICH PILE DO YOU WANT STICKS FROM";
340.2 (5) INPUT N
345.0 (5) IF N > P THEN 355
345.1 (5) IF N > INT(N) THEN 355
345.2 (5) IF N <= 0 THEN 355
350.0 (5) IF S(N) = 0 THEN 355
350.1 (5) GOTO 360
355.0 (0) PRINT "ILLEGAL PILE NUMBER."
355.1 (0) PRINT
355.2 (0) GOTO 340
360.0 (5) PRINT
360.1 (5) PRINT "HOW MANY STICKS";
360.2 (5) INPUT T
365.0 (5) IF T > S(N) THEN 370
365.1 (5) IF T > INT(T) THEN 370
365.2 (5) IF T <= 0 THEN 370
365.3 (5) GOTO 375
370.0 (0) PRINT "ILLEGAL STICK NUMBER."
370.1 (0) PRINT
370.2 (0) GOTO 360
375.0 (5) S(N) = S(N) - T
375.1 (5) G = G - T
380.0 (5) F = 1
380.1 (5) GOTO 270
385.0 (0) REM -------------------MACHINE'S MOVE-------------------------
390.0 (5) FOR I = 0 TO 4
390.1 (25) V(I) = 0
390.2 (25) NEXT I
395.0 (5) FOR I = 1 TO P
400.0 (15) C(I) = S(I)
405.0 (15) FOR E = 4 TO 0 STEP -1
410.0 (75) IF S(I) < 2 ^ E THEN 415
410.1 (13) S2(I) = S2(I) + 10 ^ E
410.2 (13) S(I) = S(I) - 2 ^ E
415.0 (75) NEXT E
420.0 (15) FOR Y = 4 TO 0 STEP -1
425.0 (75) X(I, Y) = INT(S2(I) / 10 ^ Y)
425.1 (75) S2(I) = S2(I) - X(I, Y) * 10 ^ Y
430.0 (75) V(Y) = V(Y) + X(I, Y)
435.0 (75) NEXT Y
440.0 (15) NEXT I
445.0 (5) R = 0
450.0 (5) FOR Y = 4 TO 0 STEP -1
455.0 (25) IF V(Y) / 2 - INT(V(Y) / 2) = 0 THEN 480
460.0 (15) IF R = 1 THEN 470
460.1 (11) Q = INT(P * RND(X)) + 1
465.0 (11) IF X(Q, Y) <> 1 THEN 460
465.1 (5) X(Q, Y) = 0
465.2 (5) R = 1
465.3 (5) GOTO 480
470.0 (4) IF X(Q, Y) = 1 THEN 475
470.1 (3) X(Q, Y) = 1
470.2 (3) GOTO 480
475.0 (1) X(Q, Y) = 0
480.0 (25) NEXT Y
485.0 (5) FOR I = 1 TO P
490.0 (15) S2(I) = 0
495.0 (15) FOR Y = 4 TO 0 STEP -1
500.0 (75) S3(I) = X(I, Y) * 10 ^ Y
500.1 (75) S2(I) = S2(I) + S3(I)
505.0 (75) NEXT Y
510.0 (15) FOR E = 4 TO 0 STEP -1
515.0 (75) IF S2(I) < 10 ^ E THEN 520
515.1 (10) S(I) = S(I) + 2 ^ E
515.2 (10) S2(I) = S2(I) - 10 ^ E
520.0 (75) NEXT E
525.0 (15) NEXT I
530.0 (5) IF R = 1 THEN 535
530.1 (0) Q = INT(P * RND(X)) + 1
530.2 (0) IF S(Q) = 0 THEN 530
530.3 (0) S(Q) = S(Q) - 1
535.0 (5) D = C(Q) - S(Q)
535.1 (5) G = G - D
540.0 (5) IF D = 1 THEN 550
545.0 (1) PRINT
545.1 (1) PRINT "I'LL TAKE"; D; "STICKS FROM PILE"; Q; "."
545.2 (1) GOTO 555
550.0 (4) PRINT
550.1 (4) PRINT "I'LL TAKE 1 STICK FROM PILE"; Q; "."
555.0 (5) F = 0
555.1 (5) GOTO 270
560.0 (0) END

