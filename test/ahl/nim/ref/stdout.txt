THIS PROGRAM PLAYS NIM.
DO YOU WANT INSTRUCTIONS? YES

    NIM IS PLAYED BY TWO PEOPLE PLAYING ALTERNATELY, BEFORE
THE PLAY STARTS, AN ARBITRARY NUMBER OF STICKS OR OBJECTS IS
PUT INTO AN ARBITRARY NUMBER OF PILES, IN ANY DISTRIBUTION
WHATEVER, THEN EACH PLAYER IN HIS TURN REMOVES AS MANY
STICKS AS HE WISHES FROM ANY PILEBUT FROM ONLY ONE PILE,
AND AT LEAST ONE STICK, THE PLAYER WHO TAKES THE LAST STICK
IS THE WINNER.
    THIS PROGRAM ALLOWS YOU TO SET UP THE INITIAL ARRANGEMENT
OF PILES AND STICKS. IT WILL NOT ACCEPT MORE THAN TWENTY
PILES OR STICKS IN EACH PILE.

HOW MANY PILES? 3

HOW MANY STICKS IN PILE 1 ? 5
HOW MANY STICKS IN PILE 2 ? 4
HOW MANY STICKS IN PILE 3 ? 3

DO YOU WANT TO GO FIRST? YES

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 3 STICKS FROM PILE 3 .

PlLE NUMBER     STICKS LEFT
 1               4
 2               4

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

PlLE NUMBER     STICKS LEFT
 1               3
 2               3

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

PlLE NUMBER     STICKS LEFT
 1               2
 2               2

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

PlLE NUMBER     STICKS LEFT
 1               1
 2               1

WHICH PILE DO YOU WANT STICKS FROM? 1

HOW MANY STICKS? 1

I'LL TAKE 1 STICK FROM PILE 2 .

I WON. DO YOU WANT TO PLAY AGAIN? NO
STOP in line 290

100 (0) REM THIS PROGRAM USES A STRATEGY AS PRESENTED IN 'GAMES OF FUN AND
105 (0) REM STRATEGY', A PUBLICATION OF THE MATHEMATICAL SERVICES DEPART-
110 (0) REM MENT OF COMPUTER CONTROL CO., INC.
115 (1) PRINT "THIS PROGRAM PLAYS NIM."
120 (1) PRINT "DO YOU WANT INSTRUCTIONS";
    (1) INPUT Q$
125 (1) IF Q$ = "YES" THEN 135
    (0) IF Q$ = "NO" THEN 190
130 (0) PRINT "TYPE YES OR NO."
    (0) INPUT Q$
    (0) GOTO 125
135 (1) PRINT
140 (1) PRINT "    NIM IS PLAYED BY TWO PEOPLE PLAYING ALTERNATELY, BEFORE"
145 (1) PRINT "THE PLAY STARTS, AN ARBITRARY NUMBER OF STICKS OR OBJECTS IS"
150 (1) PRINT "PUT INTO AN ARBITRARY NUMBER OF PILES, IN ANY DISTRIBUTION"
155 (1) PRINT "WHATEVER, THEN EACH PLAYER IN HIS TURN REMOVES AS MANY"
160 (1) PRINT "STICKS AS HE WISHES FROM ANY PILEBUT FROM ONLY ONE PILE,"
165 (1) PRINT "AND AT LEAST ONE STICK, THE PLAYER WHO TAKES THE LAST STICK"
170 (1) PRINT "IS THE WINNER."
175 (1) PRINT "    THIS PROGRAM ALLOWS YOU TO SET UP THE INITIAL ARRANGEMENT"
180 (1) PRINT "OF PILES AND STICKS. IT WILL NOT ACCEPT MORE THAN TWENTY"
185 (1) PRINT "PILES OR STICKS IN EACH PILE."
190 (1) RANDOM
195 (0) REM -------------------CONFIGURATION INPUT----------------------------
200 (1) DIM X(20, 4), S(20), L(20), S2(20), N2(4), C(20), S3(20), V(20)
205 (1) PRINT
    (1) PRINT "HOW MANY PILES";
    (1) INPUT P
    (1) IF P > 20 THEN 215
210 (1) IF P > INT(P) THEN 215
    (1) IF P <= 0 THEN 215
    (1) GOTO 220
215 (0) PRINT "ILLEGAL PILE NUMBER. "
    (0) PRINT
    (0) GOTO 205
220 (1) PRINT
    F(I:220.1) (1) FOR I = 1 TO P
225 F(I:220.1) (3) PRINT "HOW MANY STICKS IN PILE" I;
    F(I:220.1) (3) INPUT L(I)
    F(I:220.1) (3) IF L(I) > 20 THEN 235
230 F(I:220.1) (3) IF L(I) > INT(L(I)) THEN 235
    F(I:220.1) (3) IF L(I) <= 0 THEN 235
    F(I:220.1) (3) GOTO 240
235 F(I:220.1) (0) PRINT "ILLEGAL STICK NUMBER"
    F(I:220.1) (0) PRINT
    F(I:220.1) (0) GOTO 225
240 F(I:220.1) (3) NEXT I
245 F(I:245) (1) FOR I = 1 TO P
    F(I:245) (3) S(I) = L(I)
    F(I:245) (3) G = G + L(I)
    F(I:245) (3) NEXT I
250 (1) PRINT
    (1) PRINT "DO YOU WANT TO GO FIRST";
255 (1) INPUT Q$
    (1) IF Q$ = "YES" THEN 340
    (0) IF Q$ = "NO" THEN 390
260 (0) PRINT "TYPE YES OR NO."
    (0) GOTO 255
265 (0) REM  CONTROL OF GAME REPEATS AND TESTS FOR END OF GAME- 
270 (10) IF G = 0 THEN 275
    (9) IF F = 1 THEN 390
    (4) GOTO 320
275 (1) IF F = 1 THEN 315
280 (1) PRINT
    (1) PRINT "I WON. DO YOU WANT TO PLAY AGAIN";
285 (1) INPUT Q$
    (1) IF Q$ = "NO" THEN 290
    (0) IF Q$ = "YES" THEN 300
    (0) GOTO 295
290 (1) STOP
295 (0) PRINT "TYPE YES OR NO."
    (0) GOTO 285
300 (0) PRINT
    (0) PRINT "SAME ARRANGEMENT";
305 (0) INPUT Q$
    (0) IF Q$ = "NO" THEN 205
    (0) IF Q$ = "YES" THEN 345
310 (0) PRINT "TYPE YES OR NO."
    (0) GOTO 305
315 (0) PRINT
    (0) PRINT "YOU WON, DO YOU WANT TO PLAY AGAIN";
    (0) GOTO 285
320 (4) PRINT
    (4) PRINT "PlLE NUMBER", "STICKS LEFT"
325 F(I:325) (4) FOR I = 1 TO P
    F(I:325) (12) IF S(I) = 0 THEN 330
    F(I:325) (8) PRINT I, S(I)
330 F(I:325) (12) NEXT I
335 (0) REM -------------------PLAYER'S MOVE-------------------------
340 (5) PRINT
    (5) PRINT "WHICH PILE DO YOU WANT STICKS FROM";
    (5) INPUT N
345 (5) IF N > P THEN 355
    (5) IF N > INT(N) THEN 355
    (5) IF N <= 0 THEN 355
350 (5) IF S(N) = 0 THEN 355
    (5) GOTO 360
355 (0) PRINT "ILLEGAL PILE NUMBER."
    (0) PRINT
    (0) GOTO 340
360 (5) PRINT
    (5) PRINT "HOW MANY STICKS";
    (5) INPUT T
365 (5) IF T > S(N) THEN 370
    (5) IF T > INT(T) THEN 370
    (5) IF T <= 0 THEN 370
    (5) GOTO 375
370 (0) PRINT "ILLEGAL STICK NUMBER."
    (0) PRINT
    (0) GOTO 360
375 (5) S(N) = S(N) - T
    (5) G = G - T
380 (5) F = 1
    (5) GOTO 270
385 (0) REM -------------------MACHINE'S MOVE-------------------------
390 F(I:390) (5) FOR I = 0 TO 4
    F(I:390) (25) V(I) = 0
    F(I:390) (25) NEXT I
395 F(I:395) (5) FOR I = 1 TO P
400 F(I:395) (15) C(I) = S(I)
405 F(I:395,E:405) (15) FOR E = 4 TO 0 STEP -1
410 F(I:395,E:405) (75) IF S(I) < 2 ^ E THEN 415
    F(I:395,E:405) (13) S2(I) = S2(I) + 10 ^ E
    F(I:395,E:405) (13) S(I) = S(I) - 2 ^ E
415 F(I:395,E:405) (75) NEXT E
420 F(I:395,Y:420) (15) FOR Y = 4 TO 0 STEP -1
425 F(I:395,Y:420) (75) X(I, Y) = INT(S2(I) / 10 ^ Y)
    F(I:395,Y:420) (75) S2(I) = S2(I) - X(I, Y) * 10 ^ Y
430 F(I:395,Y:420) (75) V(Y) = V(Y) + X(I, Y)
435 F(I:395,Y:420) (75) NEXT Y
440 F(I:395) (15) NEXT I
445 (5) R = 0
450 F(Y:450) (5) FOR Y = 4 TO 0 STEP -1
455 F(Y:450) (25) IF V(Y) / 2 - INT(V(Y) / 2) = 0 THEN 480
460 F(Y:450) (15) IF R = 1 THEN 470
    F(Y:450) (11) Q = INT(P * RND(X)) + 1
465 F(Y:450) (11) IF X(Q, Y) <> 1 THEN 460
    F(Y:450) (5) X(Q, Y) = 0
    F(Y:450) (5) R = 1
    F(Y:450) (5) GOTO 480
470 F(Y:450) (4) IF X(Q, Y) = 1 THEN 475
    F(Y:450) (3) X(Q, Y) = 1
    F(Y:450) (3) GOTO 480
475 F(Y:450) (1) X(Q, Y) = 0
480 F(Y:450) (25) NEXT Y
485 F(I:485) (5) FOR I = 1 TO P
490 F(I:485) (15) S2(I) = 0
495 F(I:485,Y:495) (15) FOR Y = 4 TO 0 STEP -1
500 F(I:485,Y:495) (75) S3(I) = X(I, Y) * 10 ^ Y
    F(I:485,Y:495) (75) S2(I) = S2(I) + S3(I)
505 F(I:485,Y:495) (75) NEXT Y
510 F(I:485,E:510) (15) FOR E = 4 TO 0 STEP -1
515 F(I:485,E:510) (75) IF S2(I) < 10 ^ E THEN 520
    F(I:485,E:510) (10) S(I) = S(I) + 2 ^ E
    F(I:485,E:510) (10) S2(I) = S2(I) - 10 ^ E
520 F(I:485,E:510) (75) NEXT E
525 F(I:485) (15) NEXT I
530 (5) IF R = 1 THEN 535
    (0) Q = INT(P * RND(X)) + 1
    (0) IF S(Q) = 0 THEN 530
    (0) S(Q) = S(Q) - 1
535 (5) D = C(Q) - S(Q)
    (5) G = G - D
540 (5) IF D = 1 THEN 550
545 (1) PRINT
    (1) PRINT "I'LL TAKE"; D; "STICKS FROM PILE"; Q; "."
    (1) GOTO 555
550 (4) PRINT
    (4) PRINT "I'LL TAKE 1 STICK FROM PILE"; Q; "."
555 (5) F = 0
    (5) GOTO 270
560 (0) END

